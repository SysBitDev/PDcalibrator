# Universal String Handler (xprintf) Library

## Опис

Бібліотека `xprintf` призначена для універсальної роботи з текстовими рядками, обробки форматованого вводу та виводу у вбудованих системах. Вона реалізує функції для роботи з консольними даними: форматований вивід, обробка чисел (у тому числі з плаваючою комою), вивід дампів пам'яті та отримання чисел із текстових рядків.

## Можливості

- Форматований текстовий вивід (`xprintf`, `xsprintf`, `xfprintf`).
- Підтримка чисел з плаваючою комою (опціонально).
- Робота з довгими числами (`long long`) (опціонально).
- Конвертація чисел між десятковою, шістнадцятковою, двійковою системами.
- Вивід дампів пам'яті (`put_dump`).
- Зчитування чисел із рядків (`xatoi`, `xatof`).
- Налаштування роботи через макроси для мінімізації займаної пам’яті.

---

## Інтеграція

1. **Підключення бібліотеки:**
   - Додайте файли `xprintf.h` та `xprintf.c` до вашого проєкту.
   - Увімкніть потрібний функціонал за допомогою макросів (деталі у розділі "Налаштування").

2. **Налаштування макросів:**

   Макроси налаштовуються у файлі `xprintf.h`:

   - `XF_USE_OUTPUT`: Увімкнення функцій виводу (1 - увімкнено, 0 - вимкнено).
   - `XF_CRLF`: Перетворення символу `\n` у `\r\n` (1 - увімкнено, 0 - вимкнено).
   - `XF_USE_DUMP`: Увімкнення функції дампу пам’яті (`put_dump`).
   - `XF_USE_LLI`: Підтримка `long long` у форматованому виводі.
   - `XF_USE_FP`: Підтримка чисел із плаваючою комою.
   - `XF_USE_INPUT`: Увімкнення функцій вводу.
   - `XF_INPUT_ECHO`: Ехо-підтримка вводу.

---

## Приклади використання

### 1. Форматований вивід

Функція `xprintf` дозволяє форматований вивід у консоль або інший пристрій.

```c
#include "xprintf.h"

// Налаштування вихідного пристрою
void output_device(int chr) {
    putchar(chr); // Використання стандартного виводу
}

int main() {
    xdev_out(output_device); // Реєстрація функції виводу

    int value = 42;
    xprintf("Значення: %d\n", value); // Виведе: Значення: 42
    xprintf("Шістнадцяткове: 0x%X\n", value); // Виведе: Шістнадцяткове: 0x2A
    xprintf("Число із плаваючою комою: %.2f\n", 3.14159); // Виведе: Число із плаваючою комою: 3.14

    return 0;
}
```

---

### 2. Форматований вивід у рядок

Функція `xsprintf` записує форматований текст у рядок.

```c
#include "xprintf.h"

int main() {
    char buffer[50];
    int value = 255;

    xsprintf(buffer, "Десяткове: %d, Шістнадцяткове: 0x%X", value, value);
    printf("%s\n", buffer); // Виведе: Десяткове: 255, Шістнадцяткове: 0xFF

    return 0;
}
```

---

### 3. Зчитування чисел із рядків

Функція `xatoi` зчитує ціле число з текстового рядка.

```c
#include "xprintf.h"

int main() {
    char input[] = "12345";
    char *ptr = input;
    long value;

    if (xatoi(&ptr, &value)) {
        printf("Число: %ld\n", value); // Виведе: Число: 12345
    } else {
        printf("Помилка зчитування!\n");
    }

    return 0;
}
```

---

### 4. Вивід дампу пам'яті

Функція `put_dump` виводить дамп пам'яті у зручному форматі.

```c
#include "xprintf.h"

int main() {
    char data[] = "Hello, xprintf!";
    put_dump(data, 0x1000, sizeof(data), 1); // Вивід даних у форматі дампу

    return 0;
}
```

Приклад виводу:

```
001000  48 65 6C 6C 6F 2C 20 78 70 72 69 6E 74 66 21  Hello, xprintf!
```

---

## Налаштування та оптимізація

Бібліотека дозволяє гнучко налаштовувати функціонал:

1. **Оптимізація пам’яті:**
   - Вимкніть непотрібні функції, встановивши відповідні макроси у значення `0`.
   - Наприклад, для невеликих систем можна вимкнути підтримку чисел із плаваючою комою (`XF_USE_FP`).

2. **Вивід та ввід:**
   - Реалізуйте власні функції вводу та виводу і зареєструйте їх через `xdev_out` та `xdev_in`.

---

## Особливості

- Для роботи з числами із плаваючою комою використовується бібліотека `math.h`.
- Функції вводу (наприклад, `xgets`) працюють з кастомним джерелом даних, яке вказується через `xdev_in`.
- Максимальна довжина тексту, який обробляється функціями форматованого виводу, обмежується макросом `SZB_OUTPUT`.